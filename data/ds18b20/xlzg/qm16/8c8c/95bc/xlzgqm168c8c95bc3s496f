{"data":{"css":"","data":[],"name":"ds18b20_settings","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nme.logs = { \"list\":[] };\n\nif (ME.DATA.peer){\n  if (ME.DATA.peer != 'local') me.peer = ME.DATA.peer;\n}\nelse me.peer = typeof CURRENTDEVICEID == 'undefined' ? null : CURRENTDEVICEID;\n\nvar device = me.peer;\nvar prefix = device ? '../peerbot/remote/'+device+'/' : '../';\n\nme.ready = function(){\n  ME.DATA.big = false;\n  componentHandler.upgradeAllRegistered();\n  \n  send_list(function(result){\n    if (!ME.DATA.serial && result.data && result.data.list) ME.DATA.serial = result.data.list[0];\n    var el = $(ME).find('.selectsensor');\n    result.data.label = 'Serial Number';\n    result.data.value = ME.DATA.serial;\n    result.data.cb = function(val){\n      ME.DATA.serial = val;\n      setLogSwitch();\n    };\n    installControl(el[0], 'metabot', 'select', function(api){}, result.data);\n  }, device);\n  \n  json(prefix+'botmanager/read', 'db=runtime&id=log_ds18b20', function(result){\n    if (result.data && result.data.list){\n      me.logs = result.data;\n    }\n    setLogSwitch();\n  });\n};\n\nfunction setLogSwitch(){\n  val = me.logs.list.indexOf(ME.DATA.serial) != -1;\n  $(ME).find('.logswitch').prop('checked', val).parent()[0].MaterialSwitch.checkToggleState();\n}\n\nfunction send_list(xxxxxcb, xxxxxpeer){\n  var args = {};\n  var xxxprefix = xxxxxpeer ? '../peerbot/remote/'+xxxxxpeer+'/' : '../';\n  args = encodeURIComponent(JSON.stringify(args));\n  json(xxxprefix+'botmanager/execute', 'db=ds18b20&id=ookitt167949056f9i239&args='+args, function(result){\n    xxxxxcb(result);\n  });\n}\n\n$(ME).find('.logswitch').change(function(){\n  var val = $(this).prop(\"checked\");\n  var i = me.logs.list.indexOf(ME.DATA.serial);\n  if (val && i == -1) me.logs.list.push(ME.DATA.serial);\n  else if (!val && i != -1) me.logs.list.splice(i,1);\n  json(prefix+'botmanager/write', 'db=runtime&id=log_ds18b20&data='+encodeURIComponent(JSON.stringify(me.logs)), function(result){\n//    alert(JSON.stringify(result));\n  });\n});","groups":"anonymous","ctl":"xlzgqm168c8c95bc3s496f","html":"<div class='selectsensor'><\/div>\n<label class=\"mdl-switch mdl-js-switch mdl-js-ripple-effect\" for=\"logswitch\">\n  <input type=\"checkbox\" id=\"logswitch\" class=\"mdl-switch__input logswitch\">\n  <span class=\"mdl-switch__label\">Log<\/span>\n<\/label>","three":{"controls":[]},"db":"ds18b20","desc":""},"readers":["anonymous"],"id":"xlzgqm168c8c95bc3s496f","sessionid":"jvgvwg16b7a4d277bt3","time":1574954036317,"addr":"/0:0:0:0:0:0:0:1:49180","username":"admin"}